<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>





















    
    
    
    

  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Lab2: Classification and Numeric Prediction<a rel="noopener" class="anchor-link" href="#Lab2:-Classification-and-Numeric-Prediction">&#182;</a></h1><hr/>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Part 1: Classification<a rel="noopener" class="anchor-link" href="#Part-1:-Classification">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This data set contains information of cars purchased at the Auction.
<br/>
We will use this file to predict the quality of buying decisions and visualize decision processes.
<br/>
<br/>
VARIABLE DESCRIPTIONS:<br/>
Auction: Auction provider at which the  vehicle was purchased<br/>
Color: Vehicle Color<br/>
IsBadBuy: Identifies if the kicked vehicle was an avoidable purchase<br/>
MMRCurrentAuctionAveragePrice: Acquisition price for this vehicle in average condition as of current day<br/>
Size: The size category of the vehicle (Compact, SUV, etc.)<br/>
TopThreeAmericanName:Identifies if the manufacturer is one of the top three American manufacturers<br/>
VehBCost: Acquisition cost paid for the vehicle at time of purchase<br/>
VehicleAge: The Years elapsed since the manufacturer&#39;s year<br/>
VehOdo: The vehicles odometer reading<br/>
WarrantyCost: Warranty price (term=36month  and millage=36K)<br/>
WheelType: The vehicle wheel type description (Alloy, Covers)<br/>
<br/>
Target variable: <strong>IsBadBuy</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>1. Upload and clean data<a rel="noopener" class="anchor-link" href="#1.-Upload-and-clean-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Mounting Google Drive</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">plot_confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Read data</span>
<span class="n">carAuction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/DL_data/carAuction.csv&quot;</span><span class="p">)</span>
<span class="n">carAuction</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Auction</th>
      <th>Color</th>
      <th>IsBadBuy</th>
      <th>MMRCurrentAuctionAveragePrice</th>
      <th>Size</th>
      <th>TopThreeAmericanName</th>
      <th>VehBCost</th>
      <th>VehicleAge</th>
      <th>VehOdo</th>
      <th>WarrantyCost</th>
      <th>WheelType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ADESA</td>
      <td>WHITE</td>
      <td>No</td>
      <td>2871</td>
      <td>LARGE TRUCK</td>
      <td>FORD</td>
      <td>5300</td>
      <td>8</td>
      <td>75419</td>
      <td>869</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ADESA</td>
      <td>GOLD</td>
      <td>Yes</td>
      <td>1840</td>
      <td>VAN</td>
      <td>FORD</td>
      <td>3600</td>
      <td>8</td>
      <td>82944</td>
      <td>2322</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ADESA</td>
      <td>RED</td>
      <td>No</td>
      <td>8931</td>
      <td>SMALL SUV</td>
      <td>CHRYSLER</td>
      <td>7500</td>
      <td>4</td>
      <td>57338</td>
      <td>588</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ADESA</td>
      <td>GOLD</td>
      <td>No</td>
      <td>8320</td>
      <td>CROSSOVER</td>
      <td>FORD</td>
      <td>8500</td>
      <td>5</td>
      <td>55909</td>
      <td>1169</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ADESA</td>
      <td>GREY</td>
      <td>No</td>
      <td>11520</td>
      <td>LARGE TRUCK</td>
      <td>FORD</td>
      <td>10100</td>
      <td>5</td>
      <td>86702</td>
      <td>853</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>ADESA</td>
      <td>RED</td>
      <td>No</td>
      <td>7536</td>
      <td>SMALL SUV</td>
      <td>CHRYSLER</td>
      <td>6600</td>
      <td>4</td>
      <td>85377</td>
      <td>983</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>ADESA</td>
      <td>BLACK</td>
      <td>No</td>
      <td>4921</td>
      <td>LARGE TRUCK</td>
      <td>GM</td>
      <td>7000</td>
      <td>7</td>
      <td>89665</td>
      <td>1543</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>ADESA</td>
      <td>BLACK</td>
      <td>No</td>
      <td>9263</td>
      <td>MEDIUM SUV</td>
      <td>CHRYSLER</td>
      <td>9000</td>
      <td>4</td>
      <td>59383</td>
      <td>1417</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>ADESA</td>
      <td>BLUE</td>
      <td>No</td>
      <td>3240</td>
      <td>MEDIUM</td>
      <td>OTHER</td>
      <td>5500</td>
      <td>4</td>
      <td>48642</td>
      <td>482</td>
      <td>Covers</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>ADESA</td>
      <td>SILVER</td>
      <td>No</td>
      <td>6148</td>
      <td>MEDIUM SUV</td>
      <td>FORD</td>
      <td>7000</td>
      <td>5</td>
      <td>82563</td>
      <td>1243</td>
      <td>Alloy</td>
    </tr>
  </tbody>
</table>
<p>10000 rows &#215; 11 columns</p>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Show the head rows of a data frame</span>
<span class="n">carAuction</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Auction</th>
      <th>Color</th>
      <th>IsBadBuy</th>
      <th>MMRCurrentAuctionAveragePrice</th>
      <th>Size</th>
      <th>TopThreeAmericanName</th>
      <th>VehBCost</th>
      <th>VehicleAge</th>
      <th>VehOdo</th>
      <th>WarrantyCost</th>
      <th>WheelType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ADESA</td>
      <td>WHITE</td>
      <td>No</td>
      <td>2871</td>
      <td>LARGE TRUCK</td>
      <td>FORD</td>
      <td>5300</td>
      <td>8</td>
      <td>75419</td>
      <td>869</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ADESA</td>
      <td>GOLD</td>
      <td>Yes</td>
      <td>1840</td>
      <td>VAN</td>
      <td>FORD</td>
      <td>3600</td>
      <td>8</td>
      <td>82944</td>
      <td>2322</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ADESA</td>
      <td>RED</td>
      <td>No</td>
      <td>8931</td>
      <td>SMALL SUV</td>
      <td>CHRYSLER</td>
      <td>7500</td>
      <td>4</td>
      <td>57338</td>
      <td>588</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ADESA</td>
      <td>GOLD</td>
      <td>No</td>
      <td>8320</td>
      <td>CROSSOVER</td>
      <td>FORD</td>
      <td>8500</td>
      <td>5</td>
      <td>55909</td>
      <td>1169</td>
      <td>Alloy</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ADESA</td>
      <td>GREY</td>
      <td>No</td>
      <td>11520</td>
      <td>LARGE TRUCK</td>
      <td>FORD</td>
      <td>10100</td>
      <td>5</td>
      <td>86702</td>
      <td>853</td>
      <td>Alloy</td>
    </tr>
  </tbody>
</table>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine variable type</span>
<span class="n">carAuction</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Auction                          object
Color                            object
IsBadBuy                         object
MMRCurrentAuctionAveragePrice     int64
Size                             object
TopThreeAmericanName             object
VehBCost                          int64
VehicleAge                        int64
VehOdo                            int64
WarrantyCost                      int64
WheelType                        object
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Change categorical variables to &quot;category&quot;</span>
<span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;Auction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;Auction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;Color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;Color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;IsBadBuy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;IsBadBuy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;TopThreeAmericanName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;TopThreeAmericanName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;WheelType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;WheelType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine variable type</span>
<span class="n">carAuction</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Auction                          category
Color                            category
IsBadBuy                         category
MMRCurrentAuctionAveragePrice       int64
Size                             category
TopThreeAmericanName             category
VehBCost                            int64
VehicleAge                          int64
VehOdo                              int64
WarrantyCost                        int64
WheelType                        category
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>2. Partition the data set for Decision Tree model<a rel="noopener" class="anchor-link" href="#2.-Partition-the-data-set-for-Decision-Tree-model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Create dummy variables</span>
<span class="n">carAuction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">carAuction</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Auction&#39;</span><span class="p">,</span><span class="s1">&#39;Color&#39;</span><span class="p">,</span><span class="s1">&#39;Size&#39;</span><span class="p">,</span><span class="s1">&#39;TopThreeAmericanName&#39;</span><span class="p">,</span><span class="s1">&#39;WheelType&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">carAuction</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>IsBadBuy</th>
      <th>MMRCurrentAuctionAveragePrice</th>
      <th>VehBCost</th>
      <th>VehicleAge</th>
      <th>VehOdo</th>
      <th>WarrantyCost</th>
      <th>Auction_MANHEIM</th>
      <th>Auction_OTHER</th>
      <th>Color_BLACK</th>
      <th>Color_BLUE</th>
      <th>...</th>
      <th>Size_SMALL TRUCK</th>
      <th>Size_SPECIALTY</th>
      <th>Size_SPORTS</th>
      <th>Size_VAN</th>
      <th>TopThreeAmericanName_FORD</th>
      <th>TopThreeAmericanName_GM</th>
      <th>TopThreeAmericanName_OTHER</th>
      <th>WheelType_Covers</th>
      <th>WheelType_Special</th>
      <th>WheelType_unkwnWheel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>No</td>
      <td>2871</td>
      <td>5300</td>
      <td>8</td>
      <td>75419</td>
      <td>869</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Yes</td>
      <td>1840</td>
      <td>3600</td>
      <td>8</td>
      <td>82944</td>
      <td>2322</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>No</td>
      <td>8931</td>
      <td>7500</td>
      <td>4</td>
      <td>57338</td>
      <td>588</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>No</td>
      <td>8320</td>
      <td>8500</td>
      <td>5</td>
      <td>55909</td>
      <td>1169</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>No</td>
      <td>11520</td>
      <td>10100</td>
      <td>5</td>
      <td>86702</td>
      <td>853</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>No</td>
      <td>7536</td>
      <td>6600</td>
      <td>4</td>
      <td>85377</td>
      <td>983</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>No</td>
      <td>4921</td>
      <td>7000</td>
      <td>7</td>
      <td>89665</td>
      <td>1543</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>No</td>
      <td>9263</td>
      <td>9000</td>
      <td>4</td>
      <td>59383</td>
      <td>1417</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>No</td>
      <td>3240</td>
      <td>5500</td>
      <td>4</td>
      <td>48642</td>
      <td>482</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>No</td>
      <td>6148</td>
      <td>7000</td>
      <td>5</td>
      <td>82563</td>
      <td>1243</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>10000 rows &#215; 40 columns</p>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Partition the data to training and testing set</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">carAuction</span><span class="p">[</span><span class="s1">&#39;IsBadBuy&#39;</span><span class="p">]</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">carAuction</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;IsBadBuy&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predictors_train</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictors_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">predictors_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">target_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">target_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(7000, 39) (3000, 39) (7000,) (3000,)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the porportion of target variable for training data set</span>
<span class="nb">print</span><span class="p">(</span><span class="n">target_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>No     0.869571
Yes    0.130429
Name: IsBadBuy, dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the porportion of target variable for testing data set</span>
<span class="nb">print</span><span class="p">(</span><span class="n">target_test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>No     0.872667
Yes    0.127333
Name: IsBadBuy, dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>3. Decision Tree model prediction<a rel="noopener" class="anchor-link" href="#3.-Decision-Tree-model-prediction">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Build a decision tree model on training data with max_depth = 2</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span> <span class="o">=</span> <span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier(criterion=&#39;entropy&#39;, max_depth=2, random_state=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Plot the tree</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">predictors_train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">],</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[Text(0.5, 0.8333333333333334, &#39;WheelType_unkwnWheel &lt;= 0.5\nentropy = 0.559\nsamples = 7000\nvalue = [6087, 913]\nclass = No&#39;),
 Text(0.25, 0.5, &#39;VehicleAge &lt;= 4.5\nentropy = 0.472\nsamples = 6686\nvalue = [6011, 675]\nclass = No&#39;),
 Text(0.125, 0.16666666666666666, &#39;entropy = 0.348\nsamples = 4064\nvalue = [3799, 265]\nclass = No&#39;),
 Text(0.375, 0.16666666666666666, &#39;entropy = 0.626\nsamples = 2622\nvalue = [2212, 410]\nclass = No&#39;),
 Text(0.75, 0.5, &#39;Auction_MANHEIM &lt;= 0.5\nentropy = 0.798\nsamples = 314\nvalue = [76, 238]\nclass = Yes&#39;),
 Text(0.625, 0.16666666666666666, &#39;entropy = 0.567\nsamples = 247\nvalue = [33, 214]\nclass = Yes&#39;),
 Text(0.875, 0.16666666666666666, &#39;entropy = 0.941\nsamples = 67\nvalue = [43, 24]\nclass = No&#39;)]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q1. Find one path in the tree to a leaf node that is classified to IsBadBuy = &#39;Yes&#39;. What is this path/rule&#39;s misclassification error rate?<br/>
if WheelType =unkwnWheel, Auction!= MANHEIM, then IsBadBuy = yes
misclassification error rate:33/(33+214)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Make predictions on training and testing data</span>
<span class="n">prediction_on_train</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
<span class="n">prediction_on_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on training data: confusion_matrix</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">predictors_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">values_format</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x7f5d6072f0d0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on testing data: confusion_matrix</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">values_format</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x7f5d60c2a3d0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q2. On the testing set, how many bad buy cars are predicted as Not bad buy?<br/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on training data: accuracy, precision, recall, and f1-score</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">target_train</span><span class="p">,</span> <span class="n">prediction_on_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.90      0.99      0.94      6087
         Yes       0.87      0.23      0.37       913

    accuracy                           0.90      7000
   macro avg       0.88      0.61      0.66      7000
weighted avg       0.89      0.90      0.87      7000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on testing data: accuracy, precision, recall, and f1-score</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">target_test</span><span class="p">,</span> <span class="n">prediction_on_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.90      1.00      0.94      2618
         Yes       0.90      0.22      0.36       382

    accuracy                           0.90      3000
   macro avg       0.90      0.61      0.65      3000
weighted avg       0.90      0.90      0.87      3000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q3. Does the decision tree model have better performance on majority (IsBadBuy = &#39;No&#39;) or minority class (IsBadBuy = &#39;Yes&#39;)? why? <br/></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Build a decision tree model on training data with max_depth = 10</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span> <span class="o">=</span> <span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeClassifier(criterion=&#39;entropy&#39;, max_depth=10, random_state=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Plot the tree</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">predictors_train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">],</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[Text(0.648342803030303, 0.9545454545454546, &#39;WheelType_unkwnWheel &lt;= 0.5\nentropy = 0.559\nsamples = 7000\nvalue = [6087, 913]\nclass = No&#39;),
 Text(0.36006944444444444, 0.8636363636363636, &#39;VehicleAge &lt;= 4.5\nentropy = 0.472\nsamples = 6686\nvalue = [6011, 675]\nclass = No&#39;),
 Text(0.15138888888888888, 0.7727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 4767.0\nentropy = 0.348\nsamples = 4064\nvalue = [3799, 265]\nclass = No&#39;),
 Text(0.08434343434343435, 0.6818181818181818, &#39;WarrantyCost &lt;= 493.5\nentropy = 0.513\nsamples = 559\nvalue = [495, 64]\nclass = No&#39;),
 Text(0.0803030303030303, 0.5909090909090909, &#39;entropy = 0.0\nsamples = 36\nvalue = [36, 0]\nclass = No&#39;),
 Text(0.08838383838383838, 0.5909090909090909, &#39;MMRCurrentAuctionAveragePrice &lt;= 4695.5\nentropy = 0.536\nsamples = 523\nvalue = [459, 64]\nclass = No&#39;),
 Text(0.0595959595959596, 0.5, &#39;TopThreeAmericanName_GM &lt;= 0.5\nentropy = 0.498\nsamples = 485\nvalue = [432, 53]\nclass = No&#39;),
 Text(0.030303030303030304, 0.4090909090909091, &#39;VehBCost &lt;= 3972.5\nentropy = 0.564\nsamples = 355\nvalue = [308, 47]\nclass = No&#39;),
 Text(0.020202020202020204, 0.3181818181818182, &#39;VehBCost &lt;= 3802.5\nentropy = 0.881\nsamples = 30\nvalue = [21, 9]\nclass = No&#39;),
 Text(0.012121212121212121, 0.22727272727272727, &#39;VehBCost &lt;= 3385.0\nentropy = 0.485\nsamples = 19\nvalue = [17, 2]\nclass = No&#39;),
 Text(0.00808080808080808, 0.13636363636363635, &#39;VehBCost &lt;= 3257.5\nentropy = 1.0\nsamples = 4\nvalue = [2, 2]\nclass = No&#39;),
 Text(0.00404040404040404, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.012121212121212121, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.01616161616161616, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 15\nvalue = [15, 0]\nclass = No&#39;),
 Text(0.028282828282828285, 0.22727272727272727, &#39;TopThreeAmericanName_OTHER &lt;= 0.5\nentropy = 0.946\nsamples = 11\nvalue = [4, 7]\nclass = Yes&#39;),
 Text(0.024242424242424242, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 5\nvalue = [0, 5]\nclass = Yes&#39;),
 Text(0.03232323232323232, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 3062.0\nentropy = 0.918\nsamples = 6\nvalue = [4, 2]\nclass = No&#39;),
 Text(0.028282828282828285, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.03636363636363636, 0.045454545454545456, &#39;entropy = 0.722\nsamples = 5\nvalue = [4, 1]\nclass = No&#39;),
 Text(0.04040404040404041, 0.3181818181818182, &#39;VehOdo &lt;= 46290.0\nentropy = 0.52\nsamples = 325\nvalue = [287, 38]\nclass = No&#39;),
 Text(0.03636363636363636, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 20\nvalue = [20, 0]\nclass = No&#39;),
 Text(0.044444444444444446, 0.22727272727272727, &#39;VehBCost &lt;= 4135.0\nentropy = 0.542\nsamples = 305\nvalue = [267, 38]\nclass = No&#39;),
 Text(0.04040404040404041, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 18\nvalue = [18, 0]\nclass = No&#39;),
 Text(0.048484848484848485, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 4662.0\nentropy = 0.564\nsamples = 287\nvalue = [249, 38]\nclass = No&#39;),
 Text(0.044444444444444446, 0.045454545454545456, &#39;entropy = 0.585\nsamples = 271\nvalue = [233, 38]\nclass = No&#39;),
 Text(0.052525252525252523, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 16\nvalue = [16, 0]\nclass = No&#39;),
 Text(0.08888888888888889, 0.4090909090909091, &#39;Size_LARGE &lt;= 0.5\nentropy = 0.27\nsamples = 130\nvalue = [124, 6]\nclass = No&#39;),
 Text(0.07272727272727272, 0.3181818181818182, &#39;VehOdo &lt;= 85355.0\nentropy = 0.177\nsamples = 113\nvalue = [110, 3]\nclass = No&#39;),
 Text(0.06060606060606061, 0.22727272727272727, &#39;Color_GREEN &lt;= 0.5\nentropy = 0.081\nsamples = 100\nvalue = [99, 1]\nclass = No&#39;),
 Text(0.05656565656565657, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 98\nvalue = [98, 0]\nclass = No&#39;),
 Text(0.06464646464646465, 0.13636363636363635, &#39;VehBCost &lt;= 5595.0\nentropy = 1.0\nsamples = 2\nvalue = [1, 1]\nclass = No&#39;),
 Text(0.06060606060606061, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.06868686868686869, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.08484848484848485, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 3645.5\nentropy = 0.619\nsamples = 13\nvalue = [11, 2]\nclass = No&#39;),
 Text(0.08080808080808081, 0.13636363636363635, &#39;Color_RED &lt;= 0.5\nentropy = 1.0\nsamples = 4\nvalue = [2, 2]\nclass = No&#39;),
 Text(0.07676767676767676, 0.045454545454545456, &#39;entropy = 0.918\nsamples = 3\nvalue = [1, 2]\nclass = Yes&#39;),
 Text(0.08484848484848485, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.08888888888888889, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 9\nvalue = [9, 0]\nclass = No&#39;),
 Text(0.10505050505050505, 0.3181818181818182, &#39;VehBCost &lt;= 6067.5\nentropy = 0.672\nsamples = 17\nvalue = [14, 3]\nclass = No&#39;),
 Text(0.10101010101010101, 0.22727272727272727, &#39;VehOdo &lt;= 56810.0\nentropy = 0.918\nsamples = 9\nvalue = [6, 3]\nclass = No&#39;),
 Text(0.09696969696969697, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.10505050505050505, 0.13636363636363635, &#39;Color_WHITE &lt;= 0.5\nentropy = 1.0\nsamples = 6\nvalue = [3, 3]\nclass = No&#39;),
 Text(0.10101010101010101, 0.045454545454545456, &#39;entropy = 0.811\nsamples = 4\nvalue = [1, 3]\nclass = Yes&#39;),
 Text(0.10909090909090909, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.10909090909090909, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 8\nvalue = [8, 0]\nclass = No&#39;),
 Text(0.11717171717171718, 0.5, &#39;WheelType_Covers &lt;= 0.5\nentropy = 0.868\nsamples = 38\nvalue = [27, 11]\nclass = No&#39;),
 Text(0.11313131313131314, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 10\nvalue = [10, 0]\nclass = No&#39;),
 Text(0.12121212121212122, 0.4090909090909091, &#39;VehOdo &lt;= 45240.0\nentropy = 0.967\nsamples = 28\nvalue = [17, 11]\nclass = No&#39;),
 Text(0.11717171717171718, 0.3181818181818182, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.12525252525252525, 0.3181818181818182, &#39;Color_SILVER &lt;= 0.5\nentropy = 0.931\nsamples = 26\nvalue = [17, 9]\nclass = No&#39;),
 Text(0.11717171717171718, 0.22727272727272727, &#39;WarrantyCost &lt;= 519.0\nentropy = 0.811\nsamples = 20\nvalue = [15, 5]\nclass = No&#39;),
 Text(0.11313131313131314, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.12121212121212122, 0.13636363636363635, &#39;TopThreeAmericanName_GM &lt;= 0.5\nentropy = 0.742\nsamples = 19\nvalue = [15, 4]\nclass = No&#39;),
 Text(0.11717171717171718, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 8\nvalue = [8, 0]\nclass = No&#39;),
 Text(0.12525252525252525, 0.045454545454545456, &#39;entropy = 0.946\nsamples = 11\nvalue = [7, 4]\nclass = No&#39;),
 Text(0.13333333333333333, 0.22727272727272727, &#39;WarrantyCost &lt;= 1053.0\nentropy = 0.918\nsamples = 6\nvalue = [2, 4]\nclass = Yes&#39;),
 Text(0.1292929292929293, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [0, 3]\nclass = Yes&#39;),
 Text(0.13737373737373737, 0.13636363636363635, &#39;WarrantyCost &lt;= 1457.0\nentropy = 0.918\nsamples = 3\nvalue = [2, 1]\nclass = No&#39;),
 Text(0.13333333333333333, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.1414141414141414, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.21843434343434343, 0.6818181818181818, &#39;VehBCost &lt;= 13664.5\nentropy = 0.317\nsamples = 3505\nvalue = [3304, 201]\nclass = No&#39;),
 Text(0.2143939393939394, 0.5909090909090909, &#39;VehicleAge &lt;= 2.5\nentropy = 0.314\nsamples = 3502\nvalue = [3304, 198]\nclass = No&#39;),
 Text(0.16767676767676767, 0.5, &#39;VehOdo &lt;= 45492.5\nentropy = 0.222\nsamples = 1011\nvalue = [975, 36]\nclass = No&#39;),
 Text(0.16363636363636364, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 123\nvalue = [123, 0]\nclass = No&#39;),
 Text(0.1717171717171717, 0.4090909090909091, &#39;VehBCost &lt;= 5990.0\nentropy = 0.245\nsamples = 888\nvalue = [852, 36]\nclass = No&#39;),
 Text(0.16161616161616163, 0.3181818181818182, &#39;VehOdo &lt;= 65665.0\nentropy = 0.57\nsamples = 52\nvalue = [45, 7]\nclass = No&#39;),
 Text(0.15757575757575756, 0.22727272727272727, &#39;VehOdo &lt;= 64703.5\nentropy = 0.734\nsamples = 34\nvalue = [27, 7]\nclass = No&#39;),
 Text(0.15353535353535352, 0.13636363636363635, &#39;WarrantyCost &lt;= 1030.5\nentropy = 0.625\nsamples = 32\nvalue = [27, 5]\nclass = No&#39;),
 Text(0.1494949494949495, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 19\nvalue = [19, 0]\nclass = No&#39;),
 Text(0.15757575757575756, 0.045454545454545456, &#39;entropy = 0.961\nsamples = 13\nvalue = [8, 5]\nclass = No&#39;),
 Text(0.16161616161616163, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.16565656565656567, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 18\nvalue = [18, 0]\nclass = No&#39;),
 Text(0.18181818181818182, 0.3181818181818182, &#39;Size_MEDIUM SUV &lt;= 0.5\nentropy = 0.217\nsamples = 836\nvalue = [807, 29]\nclass = No&#39;),
 Text(0.17373737373737375, 0.22727272727272727, &#39;VehOdo &lt;= 45515.5\nentropy = 0.202\nsamples = 823\nvalue = [797, 26]\nclass = No&#39;),
 Text(0.1696969696969697, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.17777777777777778, 0.13636363636363635, &#39;VehBCost &lt;= 9065.0\nentropy = 0.196\nsamples = 822\nvalue = [797, 25]\nclass = No&#39;),
 Text(0.17373737373737375, 0.045454545454545456, &#39;entropy = 0.21\nsamples = 752\nvalue = [727, 25]\nclass = No&#39;),
 Text(0.18181818181818182, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 70\nvalue = [70, 0]\nclass = No&#39;),
 Text(0.1898989898989899, 0.22727272727272727, &#39;WarrantyCost &lt;= 599.5\nentropy = 0.779\nsamples = 13\nvalue = [10, 3]\nclass = No&#39;),
 Text(0.18585858585858586, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.19393939393939394, 0.13636363636363635, &#39;VehOdo &lt;= 63413.0\nentropy = 0.439\nsamples = 11\nvalue = [10, 1]\nclass = No&#39;),
 Text(0.1898989898989899, 0.045454545454545456, &#39;entropy = 1.0\nsamples = 2\nvalue = [1, 1]\nclass = No&#39;),
 Text(0.19797979797979798, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 9\nvalue = [9, 0]\nclass = No&#39;),
 Text(0.2611111111111111, 0.5, &#39;WarrantyCost &lt;= 689.5\nentropy = 0.347\nsamples = 2491\nvalue = [2329, 162]\nclass = No&#39;),
 Text(0.22626262626262628, 0.4090909090909091, &#39;VehOdo &lt;= 76403.5\nentropy = 0.18\nsamples = 332\nvalue = [323, 9]\nclass = No&#39;),
 Text(0.21414141414141413, 0.3181818181818182, &#39;Size_CROSSOVER &lt;= 0.5\nentropy = 0.116\nsamples = 257\nvalue = [253, 4]\nclass = No&#39;),
 Text(0.20606060606060606, 0.22727272727272727, &#39;VehOdo &lt;= 57031.5\nentropy = 0.093\nsamples = 253\nvalue = [250, 3]\nclass = No&#39;),
 Text(0.20202020202020202, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 117\nvalue = [117, 0]\nclass = No&#39;),
 Text(0.2101010101010101, 0.13636363636363635, &#39;VehOdo &lt;= 57104.0\nentropy = 0.153\nsamples = 136\nvalue = [133, 3]\nclass = No&#39;),
 Text(0.20606060606060606, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.21414141414141413, 0.045454545454545456, &#39;entropy = 0.063\nsamples = 134\nvalue = [133, 1]\nclass = No&#39;),
 Text(0.2222222222222222, 0.22727272727272727, &#39;Color_GOLD &lt;= 0.5\nentropy = 0.811\nsamples = 4\nvalue = [3, 1]\nclass = No&#39;),
 Text(0.21818181818181817, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.22626262626262628, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.2383838383838384, 0.3181818181818182, &#39;VehOdo &lt;= 76575.0\nentropy = 0.353\nsamples = 75\nvalue = [70, 5]\nclass = No&#39;),
 Text(0.23434343434343435, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.24242424242424243, 0.22727272727272727, &#39;Size_LARGE TRUCK &lt;= 0.5\nentropy = 0.303\nsamples = 74\nvalue = [70, 4]\nclass = No&#39;),
 Text(0.23434343434343435, 0.13636363636363635, &#39;Color_ORANGE &lt;= 0.5\nentropy = 0.198\nsamples = 65\nvalue = [63, 2]\nclass = No&#39;),
 Text(0.23030303030303031, 0.045454545454545456, &#39;entropy = 0.118\nsamples = 63\nvalue = [62, 1]\nclass = No&#39;),
 Text(0.2383838383838384, 0.045454545454545456, &#39;entropy = 1.0\nsamples = 2\nvalue = [1, 1]\nclass = No&#39;),
 Text(0.2505050505050505, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 9774.0\nentropy = 0.764\nsamples = 9\nvalue = [7, 2]\nclass = No&#39;),
 Text(0.24646464646464647, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 7\nvalue = [7, 0]\nclass = No&#39;),
 Text(0.2545454545454545, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.295959595959596, 0.4090909090909091, &#39;Size_SPECIALTY &lt;= 0.5\nentropy = 0.369\nsamples = 2159\nvalue = [2006, 153]\nclass = No&#39;),
 Text(0.28484848484848485, 0.3181818181818182, &#39;VehOdo &lt;= 89498.5\nentropy = 0.381\nsamples = 2054\nvalue = [1902, 152]\nclass = No&#39;),
 Text(0.27474747474747474, 0.22727272727272727, &#39;VehOdo &lt;= 83074.5\nentropy = 0.394\nsamples = 1934\nvalue = [1784, 150]\nclass = No&#39;),
 Text(0.26666666666666666, 0.13636363636363635, &#39;WarrantyCost &lt;= 2121.5\nentropy = 0.364\nsamples = 1612\nvalue = [1500, 112]\nclass = No&#39;),
 Text(0.26262626262626265, 0.045454545454545456, &#39;entropy = 0.372\nsamples = 1565\nvalue = [1453, 112]\nclass = No&#39;),
 Text(0.27070707070707073, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 47\nvalue = [47, 0]\nclass = No&#39;),
 Text(0.2828282828282828, 0.13636363636363635, &#39;VehOdo &lt;= 83103.0\nentropy = 0.524\nsamples = 322\nvalue = [284, 38]\nclass = No&#39;),
 Text(0.2787878787878788, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 4\nvalue = [0, 4]\nclass = Yes&#39;),
 Text(0.2868686868686869, 0.045454545454545456, &#39;entropy = 0.491\nsamples = 318\nvalue = [284, 34]\nclass = No&#39;),
 Text(0.29494949494949496, 0.22727272727272727, &#39;Size_SMALL SUV &lt;= 0.5\nentropy = 0.122\nsamples = 120\nvalue = [118, 2]\nclass = No&#39;),
 Text(0.2909090909090909, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 112\nvalue = [112, 0]\nclass = No&#39;),
 Text(0.298989898989899, 0.13636363636363635, &#39;WarrantyCost &lt;= 1566.5\nentropy = 0.811\nsamples = 8\nvalue = [6, 2]\nclass = No&#39;),
 Text(0.29494949494949496, 0.045454545454545456, &#39;entropy = 0.592\nsamples = 7\nvalue = [6, 1]\nclass = No&#39;),
 Text(0.30303030303030304, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.30707070707070705, 0.3181818181818182, &#39;TopThreeAmericanName_OTHER &lt;= 0.5\nentropy = 0.078\nsamples = 105\nvalue = [104, 1]\nclass = No&#39;),
 Text(0.30303030303030304, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 97\nvalue = [97, 0]\nclass = No&#39;),
 Text(0.3111111111111111, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 9659.0\nentropy = 0.544\nsamples = 8\nvalue = [7, 1]\nclass = No&#39;),
 Text(0.30707070707070705, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 6\nvalue = [6, 0]\nclass = No&#39;),
 Text(0.3151515151515151, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 10463.5\nentropy = 1.0\nsamples = 2\nvalue = [1, 1]\nclass = No&#39;),
 Text(0.3111111111111111, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.3191919191919192, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.22247474747474746, 0.5909090909090909, &#39;entropy = 0.0\nsamples = 3\nvalue = [0, 3]\nclass = Yes&#39;),
 Text(0.56875, 0.7727272727272727, &#39;VehBCost &lt;= 4692.5\nentropy = 0.626\nsamples = 2622\nvalue = [2212, 410]\nclass = No&#39;),
 Text(0.4436868686868687, 0.6818181818181818, &#39;VehicleAge &lt;= 5.5\nentropy = 0.779\nsamples = 634\nvalue = [488, 146]\nclass = No&#39;),
 Text(0.3838383838383838, 0.5909090909090909, &#39;Color_BLUE &lt;= 0.5\nentropy = 0.605\nsamples = 189\nvalue = [161, 28]\nclass = No&#39;),
 Text(0.3797979797979798, 0.5, &#39;VehBCost &lt;= 4017.5\nentropy = 0.648\nsamples = 169\nvalue = [141, 28]\nclass = No&#39;),
 Text(0.34545454545454546, 0.4090909090909091, &#39;VehBCost &lt;= 3687.5\nentropy = 0.831\nsamples = 57\nvalue = [42, 15]\nclass = No&#39;),
 Text(0.33131313131313134, 0.3181818181818182, &#39;WarrantyCost &lt;= 560.5\nentropy = 0.544\nsamples = 32\nvalue = [28, 4]\nclass = No&#39;),
 Text(0.32727272727272727, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.33535353535353535, 0.22727272727272727, &#39;Size_VAN &lt;= 0.5\nentropy = 0.353\nsamples = 30\nvalue = [28, 2]\nclass = No&#39;),
 Text(0.33131313131313134, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 2796.5\nentropy = 0.216\nsamples = 29\nvalue = [28, 1]\nclass = No&#39;),
 Text(0.32727272727272727, 0.045454545454545456, &#39;entropy = 0.65\nsamples = 6\nvalue = [5, 1]\nclass = No&#39;),
 Text(0.33535353535353535, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 23\nvalue = [23, 0]\nclass = No&#39;),
 Text(0.3393939393939394, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.3595959595959596, 0.3181818181818182, &#39;MMRCurrentAuctionAveragePrice &lt;= 3109.0\nentropy = 0.99\nsamples = 25\nvalue = [14, 11]\nclass = No&#39;),
 Text(0.3515151515151515, 0.22727272727272727, &#39;WheelType_Covers &lt;= 0.5\nentropy = 0.75\nsamples = 14\nvalue = [11, 3]\nclass = No&#39;),
 Text(0.3474747474747475, 0.13636363636363635, &#39;VehBCost &lt;= 3760.0\nentropy = 0.985\nsamples = 7\nvalue = [4, 3]\nclass = No&#39;),
 Text(0.3434343434343434, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.3515151515151515, 0.045454545454545456, &#39;entropy = 0.722\nsamples = 5\nvalue = [4, 1]\nclass = No&#39;),
 Text(0.35555555555555557, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 7\nvalue = [7, 0]\nclass = No&#39;),
 Text(0.36767676767676766, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 3586.5\nentropy = 0.845\nsamples = 11\nvalue = [3, 8]\nclass = Yes&#39;),
 Text(0.36363636363636365, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 5\nvalue = [0, 5]\nclass = Yes&#39;),
 Text(0.3717171717171717, 0.13636363636363635, &#39;Auction_MANHEIM &lt;= 0.5\nentropy = 1.0\nsamples = 6\nvalue = [3, 3]\nclass = No&#39;),
 Text(0.36767676767676766, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.37575757575757573, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 3\nvalue = [0, 3]\nclass = Yes&#39;),
 Text(0.41414141414141414, 0.4090909090909091, &#39;WarrantyCost &lt;= 1292.0\nentropy = 0.518\nsamples = 112\nvalue = [99, 13]\nclass = No&#39;),
 Text(0.4, 0.3181818181818182, &#39;MMRCurrentAuctionAveragePrice &lt;= 3637.5\nentropy = 0.605\nsamples = 81\nvalue = [69, 12]\nclass = No&#39;),
 Text(0.39191919191919194, 0.22727272727272727, &#39;VehOdo &lt;= 77987.0\nentropy = 0.439\nsamples = 55\nvalue = [50, 5]\nclass = No&#39;),
 Text(0.3878787878787879, 0.13636363636363635, &#39;VehOdo &lt;= 74953.0\nentropy = 0.602\nsamples = 34\nvalue = [29, 5]\nclass = No&#39;),
 Text(0.3838383838383838, 0.045454545454545456, &#39;entropy = 0.362\nsamples = 29\nvalue = [27, 2]\nclass = No&#39;),
 Text(0.39191919191919194, 0.045454545454545456, &#39;entropy = 0.971\nsamples = 5\nvalue = [2, 3]\nclass = Yes&#39;),
 Text(0.39595959595959596, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 21\nvalue = [21, 0]\nclass = No&#39;),
 Text(0.4080808080808081, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 3681.5\nentropy = 0.84\nsamples = 26\nvalue = [19, 7]\nclass = No&#39;),
 Text(0.40404040404040403, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [0, 3]\nclass = Yes&#39;),
 Text(0.4121212121212121, 0.13636363636363635, &#39;Auction_MANHEIM &lt;= 0.5\nentropy = 0.667\nsamples = 23\nvalue = [19, 4]\nclass = No&#39;),
 Text(0.4080808080808081, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 10\nvalue = [10, 0]\nclass = No&#39;),
 Text(0.4161616161616162, 0.045454545454545456, &#39;entropy = 0.89\nsamples = 13\nvalue = [9, 4]\nclass = No&#39;),
 Text(0.42828282828282827, 0.3181818181818182, &#39;MMRCurrentAuctionAveragePrice &lt;= 2668.0\nentropy = 0.206\nsamples = 31\nvalue = [30, 1]\nclass = No&#39;),
 Text(0.42424242424242425, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 2508.0\nentropy = 0.811\nsamples = 4\nvalue = [3, 1]\nclass = No&#39;),
 Text(0.4202020202020202, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.42828282828282827, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.43232323232323233, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 27\nvalue = [27, 0]\nclass = No&#39;),
 Text(0.3878787878787879, 0.5, &#39;entropy = 0.0\nsamples = 20\nvalue = [20, 0]\nclass = No&#39;),
 Text(0.5035353535353535, 0.5909090909090909, &#39;Auction_OTHER &lt;= 0.5\nentropy = 0.834\nsamples = 445\nvalue = [327, 118]\nclass = No&#39;),
 Text(0.4575757575757576, 0.5, &#39;VehOdo &lt;= 81752.5\nentropy = 0.881\nsamples = 354\nvalue = [248, 106]\nclass = No&#39;),
 Text(0.4404040404040404, 0.4090909090909091, &#39;VehOdo &lt;= 41862.5\nentropy = 0.776\nsamples = 188\nvalue = [145, 43]\nclass = No&#39;),
 Text(0.43636363636363634, 0.3181818181818182, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.4444444444444444, 0.3181818181818182, &#39;VehBCost &lt;= 2632.5\nentropy = 0.761\nsamples = 186\nvalue = [145, 41]\nclass = No&#39;),
 Text(0.4404040404040404, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.4484848484848485, 0.22727272727272727, &#39;TopThreeAmericanName_OTHER &lt;= 0.5\nentropy = 0.745\nsamples = 184\nvalue = [145, 39]\nclass = No&#39;),
 Text(0.4444444444444444, 0.13636363636363635, &#39;Color_BROWN &lt;= 0.5\nentropy = 0.791\nsamples = 164\nvalue = [125, 39]\nclass = No&#39;),
 Text(0.4404040404040404, 0.045454545454545456, &#39;entropy = 0.775\nsamples = 162\nvalue = [125, 37]\nclass = No&#39;),
 Text(0.4484848484848485, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.45252525252525255, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 20\nvalue = [20, 0]\nclass = No&#39;),
 Text(0.47474747474747475, 0.4090909090909091, &#39;VehOdo &lt;= 82966.0\nentropy = 0.958\nsamples = 166\nvalue = [103, 63]\nclass = No&#39;),
 Text(0.46060606060606063, 0.3181818181818182, &#39;Color_GREY &lt;= 0.5\nentropy = 0.722\nsamples = 10\nvalue = [2, 8]\nclass = Yes&#39;),
 Text(0.45656565656565656, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 8\nvalue = [0, 8]\nclass = Yes&#39;),
 Text(0.46464646464646464, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.4888888888888889, 0.3181818181818182, &#39;WarrantyCost &lt;= 2479.0\nentropy = 0.936\nsamples = 156\nvalue = [101, 55]\nclass = No&#39;),
 Text(0.4727272727272727, 0.22727272727272727, &#39;TopThreeAmericanName_GM &lt;= 0.5\nentropy = 0.89\nsamples = 130\nvalue = [90, 40]\nclass = No&#39;),
 Text(0.46464646464646464, 0.13636363636363635, &#39;WarrantyCost &lt;= 907.0\nentropy = 0.952\nsamples = 94\nvalue = [59, 35]\nclass = No&#39;),
 Text(0.46060606060606063, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 7\nvalue = [7, 0]\nclass = No&#39;),
 Text(0.4686868686868687, 0.045454545454545456, &#39;entropy = 0.972\nsamples = 87\nvalue = [52, 35]\nclass = No&#39;),
 Text(0.4808080808080808, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 2724.0\nentropy = 0.581\nsamples = 36\nvalue = [31, 5]\nclass = No&#39;),
 Text(0.4767676767676768, 0.045454545454545456, &#39;entropy = 0.946\nsamples = 11\nvalue = [7, 4]\nclass = No&#39;),
 Text(0.48484848484848486, 0.045454545454545456, &#39;entropy = 0.242\nsamples = 25\nvalue = [24, 1]\nclass = No&#39;),
 Text(0.5050505050505051, 0.22727272727272727, &#39;VehicleAge &lt;= 6.5\nentropy = 0.983\nsamples = 26\nvalue = [11, 15]\nclass = Yes&#39;),
 Text(0.49696969696969695, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 3742.0\nentropy = 0.544\nsamples = 8\nvalue = [1, 7]\nclass = Yes&#39;),
 Text(0.49292929292929294, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 7\nvalue = [0, 7]\nclass = Yes&#39;),
 Text(0.501010101010101, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.5131313131313131, 0.13636363636363635, &#39;VehicleAge &lt;= 8.5\nentropy = 0.991\nsamples = 18\nvalue = [10, 8]\nclass = No&#39;),
 Text(0.509090909090909, 0.045454545454545456, &#39;entropy = 0.954\nsamples = 16\nvalue = [10, 6]\nclass = No&#39;),
 Text(0.5171717171717172, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.5494949494949495, 0.5, &#39;VehBCost &lt;= 4680.0\nentropy = 0.563\nsamples = 91\nvalue = [79, 12]\nclass = No&#39;),
 Text(0.5454545454545454, 0.4090909090909091, &#39;MMRCurrentAuctionAveragePrice &lt;= 2476.0\nentropy = 0.507\nsamples = 89\nvalue = [79, 10]\nclass = No&#39;),
 Text(0.5373737373737374, 0.3181818181818182, &#39;VehBCost &lt;= 4185.0\nentropy = 0.811\nsamples = 28\nvalue = [21, 7]\nclass = No&#39;),
 Text(0.5333333333333333, 0.22727272727272727, &#39;WarrantyCost &lt;= 2414.0\nentropy = 0.918\nsamples = 21\nvalue = [14, 7]\nclass = No&#39;),
 Text(0.5292929292929293, 0.13636363636363635, &#39;WarrantyCost &lt;= 1363.0\nentropy = 0.977\nsamples = 17\nvalue = [10, 7]\nclass = No&#39;),
 Text(0.5252525252525253, 0.045454545454545456, &#39;entropy = 0.722\nsamples = 10\nvalue = [8, 2]\nclass = No&#39;),
 Text(0.5333333333333333, 0.045454545454545456, &#39;entropy = 0.863\nsamples = 7\nvalue = [2, 5]\nclass = Yes&#39;),
 Text(0.5373737373737374, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 4\nvalue = [4, 0]\nclass = No&#39;),
 Text(0.5414141414141415, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 7\nvalue = [7, 0]\nclass = No&#39;),
 Text(0.5535353535353535, 0.3181818181818182, &#39;Color_WHITE &lt;= 0.5\nentropy = 0.283\nsamples = 61\nvalue = [58, 3]\nclass = No&#39;),
 Text(0.5494949494949495, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 46\nvalue = [46, 0]\nclass = No&#39;),
 Text(0.5575757575757576, 0.22727272727272727, &#39;VehBCost &lt;= 4137.5\nentropy = 0.722\nsamples = 15\nvalue = [12, 3]\nclass = No&#39;),
 Text(0.5535353535353535, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 7\nvalue = [7, 0]\nclass = No&#39;),
 Text(0.5616161616161616, 0.13636363636363635, &#39;VehOdo &lt;= 87628.5\nentropy = 0.954\nsamples = 8\nvalue = [5, 3]\nclass = No&#39;),
 Text(0.5575757575757576, 0.045454545454545456, &#39;entropy = 1.0\nsamples = 6\nvalue = [3, 3]\nclass = No&#39;),
 Text(0.5656565656565656, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.5535353535353535, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.6938131313131313, 0.6818181818181818, &#39;Auction_MANHEIM &lt;= 0.5\nentropy = 0.565\nsamples = 1988\nvalue = [1724, 264]\nclass = No&#39;),
 Text(0.6282828282828283, 0.5909090909090909, &#39;WarrantyCost &lt;= 621.5\nentropy = 0.465\nsamples = 770\nvalue = [694, 76]\nclass = No&#39;),
 Text(0.6242424242424243, 0.5, &#39;entropy = 0.0\nsamples = 43\nvalue = [43, 0]\nclass = No&#39;),
 Text(0.6323232323232323, 0.5, &#39;WarrantyCost &lt;= 2336.5\nentropy = 0.483\nsamples = 727\nvalue = [651, 76]\nclass = No&#39;),
 Text(0.6282828282828283, 0.4090909090909091, &#39;Color_SILVER &lt;= 0.5\nentropy = 0.501\nsamples = 688\nvalue = [612, 76]\nclass = No&#39;),
 Text(0.602020202020202, 0.3181818181818182, &#39;TopThreeAmericanName_GM &lt;= 0.5\nentropy = 0.448\nsamples = 546\nvalue = [495, 51]\nclass = No&#39;),
 Text(0.5858585858585859, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 7457.0\nentropy = 0.517\nsamples = 371\nvalue = [328, 43]\nclass = No&#39;),
 Text(0.5777777777777777, 0.13636363636363635, &#39;WarrantyCost &lt;= 2270.0\nentropy = 0.565\nsamples = 316\nvalue = [274, 42]\nclass = No&#39;),
 Text(0.5737373737373738, 0.045454545454545456, &#39;entropy = 0.558\nsamples = 315\nvalue = [274, 41]\nclass = No&#39;),
 Text(0.5818181818181818, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.593939393939394, 0.13636363636363635, &#39;Color_WHITE &lt;= 0.5\nentropy = 0.131\nsamples = 55\nvalue = [54, 1]\nclass = No&#39;),
 Text(0.5898989898989899, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 46\nvalue = [46, 0]\nclass = No&#39;),
 Text(0.597979797979798, 0.045454545454545456, &#39;entropy = 0.503\nsamples = 9\nvalue = [8, 1]\nclass = No&#39;),
 Text(0.6181818181818182, 0.22727272727272727, &#39;WarrantyCost &lt;= 1908.0\nentropy = 0.268\nsamples = 175\nvalue = [167, 8]\nclass = No&#39;),
 Text(0.6101010101010101, 0.13636363636363635, &#39;VehBCost &lt;= 7860.0\nentropy = 0.121\nsamples = 121\nvalue = [119, 2]\nclass = No&#39;),
 Text(0.6060606060606061, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 91\nvalue = [91, 0]\nclass = No&#39;),
 Text(0.6141414141414141, 0.045454545454545456, &#39;entropy = 0.353\nsamples = 30\nvalue = [28, 2]\nclass = No&#39;),
 Text(0.6262626262626263, 0.13636363636363635, &#39;VehBCost &lt;= 5190.0\nentropy = 0.503\nsamples = 54\nvalue = [48, 6]\nclass = No&#39;),
 Text(0.6222222222222222, 0.045454545454545456, &#39;entropy = 0.811\nsamples = 4\nvalue = [1, 3]\nclass = Yes&#39;),
 Text(0.6303030303030303, 0.045454545454545456, &#39;entropy = 0.327\nsamples = 50\nvalue = [47, 3]\nclass = No&#39;),
 Text(0.6545454545454545, 0.3181818181818182, &#39;VehBCost &lt;= 10427.5\nentropy = 0.671\nsamples = 142\nvalue = [117, 25]\nclass = No&#39;),
 Text(0.6505050505050505, 0.22727272727272727, &#39;VehBCost &lt;= 5047.5\nentropy = 0.644\nsamples = 140\nvalue = [117, 23]\nclass = No&#39;),
 Text(0.6424242424242425, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 2849.0\nentropy = 0.959\nsamples = 21\nvalue = [13, 8]\nclass = No&#39;),
 Text(0.6383838383838384, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 6\nvalue = [6, 0]\nclass = No&#39;),
 Text(0.6464646464646465, 0.045454545454545456, &#39;entropy = 0.997\nsamples = 15\nvalue = [7, 8]\nclass = Yes&#39;),
 Text(0.6585858585858586, 0.13636363636363635, &#39;Auction_OTHER &lt;= 0.5\nentropy = 0.547\nsamples = 119\nvalue = [104, 15]\nclass = No&#39;),
 Text(0.6545454545454545, 0.045454545454545456, &#39;entropy = 0.319\nsamples = 69\nvalue = [65, 4]\nclass = No&#39;),
 Text(0.6626262626262627, 0.045454545454545456, &#39;entropy = 0.76\nsamples = 50\nvalue = [39, 11]\nclass = No&#39;),
 Text(0.6585858585858586, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.6363636363636364, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 39\nvalue = [39, 0]\nclass = No&#39;),
 Text(0.7593434343434343, 0.5909090909090909, &#39;VehicleAge &lt;= 7.5\nentropy = 0.621\nsamples = 1218\nvalue = [1030, 188]\nclass = No&#39;),
 Text(0.7186868686868687, 0.5, &#39;VehOdo &lt;= 54334.0\nentropy = 0.589\nsamples = 1127\nvalue = [967, 160]\nclass = No&#39;),
 Text(0.6888888888888889, 0.4090909090909091, &#39;MMRCurrentAuctionAveragePrice &lt;= 5795.0\nentropy = 0.295\nsamples = 96\nvalue = [91, 5]\nclass = No&#39;),
 Text(0.6787878787878788, 0.3181818181818182, &#39;WheelType_Special &lt;= 0.5\nentropy = 0.161\nsamples = 85\nvalue = [83, 2]\nclass = No&#39;),
 Text(0.6707070707070707, 0.22727272727272727, &#39;Color_GOLD &lt;= 0.5\nentropy = 0.095\nsamples = 82\nvalue = [81, 1]\nclass = No&#39;),
 Text(0.6666666666666666, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 75\nvalue = [75, 0]\nclass = No&#39;),
 Text(0.6747474747474748, 0.13636363636363635, &#39;TopThreeAmericanName_OTHER &lt;= 0.5\nentropy = 0.592\nsamples = 7\nvalue = [6, 1]\nclass = No&#39;),
 Text(0.6707070707070707, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 6\nvalue = [6, 0]\nclass = No&#39;),
 Text(0.6787878787878788, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.6868686868686869, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 3381.5\nentropy = 0.918\nsamples = 3\nvalue = [2, 1]\nclass = No&#39;),
 Text(0.6828282828282828, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.6909090909090909, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.6989898989898989, 0.3181818181818182, &#39;WarrantyCost &lt;= 828.0\nentropy = 0.845\nsamples = 11\nvalue = [8, 3]\nclass = No&#39;),
 Text(0.694949494949495, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 5\nvalue = [5, 0]\nclass = No&#39;),
 Text(0.703030303030303, 0.22727272727272727, &#39;VehBCost &lt;= 7650.0\nentropy = 1.0\nsamples = 6\nvalue = [3, 3]\nclass = No&#39;),
 Text(0.6989898989898989, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.7070707070707071, 0.13636363636363635, &#39;TopThreeAmericanName_OTHER &lt;= 0.5\nentropy = 0.811\nsamples = 4\nvalue = [3, 1]\nclass = No&#39;),
 Text(0.703030303030303, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.7111111111111111, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.7484848484848485, 0.4090909090909091, &#39;MMRCurrentAuctionAveragePrice &lt;= 10494.5\nentropy = 0.611\nsamples = 1031\nvalue = [876, 155]\nclass = No&#39;),
 Text(0.7373737373737373, 0.3181818181818182, &#39;VehicleAge &lt;= 5.5\nentropy = 0.605\nsamples = 1026\nvalue = [874, 152]\nclass = No&#39;),
 Text(0.7272727272727273, 0.22727272727272727, &#39;VehOdo &lt;= 92875.5\nentropy = 0.542\nsamples = 562\nvalue = [492, 70]\nclass = No&#39;),
 Text(0.7232323232323232, 0.13636363636363635, &#39;VehBCost &lt;= 4852.5\nentropy = 0.557\nsamples = 539\nvalue = [469, 70]\nclass = No&#39;),
 Text(0.7191919191919192, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 18\nvalue = [18, 0]\nclass = No&#39;),
 Text(0.7272727272727273, 0.045454545454545456, &#39;entropy = 0.569\nsamples = 521\nvalue = [451, 70]\nclass = No&#39;),
 Text(0.7313131313131314, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 23\nvalue = [23, 0]\nclass = No&#39;),
 Text(0.7474747474747475, 0.22727272727272727, &#39;WarrantyCost &lt;= 814.0\nentropy = 0.673\nsamples = 464\nvalue = [382, 82]\nclass = No&#39;),
 Text(0.7393939393939394, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 5334.0\nentropy = 0.318\nsamples = 52\nvalue = [49, 3]\nclass = No&#39;),
 Text(0.7353535353535353, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 28\nvalue = [28, 0]\nclass = No&#39;),
 Text(0.7434343434343434, 0.045454545454545456, &#39;entropy = 0.544\nsamples = 24\nvalue = [21, 3]\nclass = No&#39;),
 Text(0.7555555555555555, 0.13636363636363635, &#39;VehBCost &lt;= 9467.5\nentropy = 0.705\nsamples = 412\nvalue = [333, 79]\nclass = No&#39;),
 Text(0.7515151515151515, 0.045454545454545456, &#39;entropy = 0.737\nsamples = 361\nvalue = [286, 75]\nclass = No&#39;),
 Text(0.7595959595959596, 0.045454545454545456, &#39;entropy = 0.397\nsamples = 51\nvalue = [47, 4]\nclass = No&#39;),
 Text(0.7595959595959596, 0.3181818181818182, &#39;TopThreeAmericanName_GM &lt;= 0.5\nentropy = 0.971\nsamples = 5\nvalue = [2, 3]\nclass = Yes&#39;),
 Text(0.7555555555555555, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 3\nvalue = [0, 3]\nclass = Yes&#39;),
 Text(0.7636363636363637, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.8, 0.5, &#39;WarrantyCost &lt;= 1805.5\nentropy = 0.89\nsamples = 91\nvalue = [63, 28]\nclass = No&#39;),
 Text(0.7838383838383839, 0.4090909090909091, &#39;VehOdo &lt;= 86880.5\nentropy = 0.787\nsamples = 68\nvalue = [52, 16]\nclass = No&#39;),
 Text(0.7757575757575758, 0.3181818181818182, &#39;Color_MAROON &lt;= 0.5\nentropy = 0.629\nsamples = 57\nvalue = [48, 9]\nclass = No&#39;),
 Text(0.7717171717171717, 0.22727272727272727, &#39;VehBCost &lt;= 5265.0\nentropy = 0.55\nsamples = 55\nvalue = [48, 7]\nclass = No&#39;),
 Text(0.7676767676767676, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 17\nvalue = [17, 0]\nclass = No&#39;),
 Text(0.7757575757575758, 0.13636363636363635, &#39;VehBCost &lt;= 5622.5\nentropy = 0.689\nsamples = 38\nvalue = [31, 7]\nclass = No&#39;),
 Text(0.7717171717171717, 0.045454545454545456, &#39;entropy = 0.918\nsamples = 6\nvalue = [2, 4]\nclass = Yes&#39;),
 Text(0.7797979797979798, 0.045454545454545456, &#39;entropy = 0.449\nsamples = 32\nvalue = [29, 3]\nclass = No&#39;),
 Text(0.7797979797979798, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.7919191919191919, 0.3181818181818182, &#39;VehOdo &lt;= 94714.5\nentropy = 0.946\nsamples = 11\nvalue = [4, 7]\nclass = Yes&#39;),
 Text(0.7878787878787878, 0.22727272727272727, &#39;VehBCost &lt;= 8712.5\nentropy = 0.544\nsamples = 8\nvalue = [1, 7]\nclass = Yes&#39;),
 Text(0.7838383838383839, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 7\nvalue = [0, 7]\nclass = Yes&#39;),
 Text(0.7919191919191919, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.795959595959596, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.8161616161616162, 0.4090909090909091, &#39;VehOdo &lt;= 86992.0\nentropy = 0.999\nsamples = 23\nvalue = [11, 12]\nclass = Yes&#39;),
 Text(0.8080808080808081, 0.3181818181818182, &#39;VehBCost &lt;= 5625.0\nentropy = 0.896\nsamples = 16\nvalue = [5, 11]\nclass = Yes&#39;),
 Text(0.804040404040404, 0.22727272727272727, &#39;VehicleAge &lt;= 8.5\nentropy = 0.954\nsamples = 8\nvalue = [5, 3]\nclass = No&#39;),
 Text(0.8, 0.13636363636363635, &#39;Size_LARGE &lt;= 0.5\nentropy = 1.0\nsamples = 6\nvalue = [3, 3]\nclass = No&#39;),
 Text(0.795959595959596, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.804040404040404, 0.045454545454545456, &#39;entropy = 0.811\nsamples = 4\nvalue = [3, 1]\nclass = No&#39;),
 Text(0.8080808080808081, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.8121212121212121, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 8\nvalue = [0, 8]\nclass = Yes&#39;),
 Text(0.8242424242424242, 0.3181818181818182, &#39;Color_BLACK &lt;= 0.5\nentropy = 0.592\nsamples = 7\nvalue = [6, 1]\nclass = No&#39;),
 Text(0.8202020202020202, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 6\nvalue = [6, 0]\nclass = No&#39;),
 Text(0.8282828282828283, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.9366161616161616, 0.8636363636363636, &#39;Auction_MANHEIM &lt;= 0.5\nentropy = 0.798\nsamples = 314\nvalue = [76, 238]\nclass = Yes&#39;),
 Text(0.8934343434343435, 0.7727272727272727, &#39;VehOdo &lt;= 81450.5\nentropy = 0.567\nsamples = 247\nvalue = [33, 214]\nclass = Yes&#39;),
 Text(0.8737373737373737, 0.6818181818181818, &#39;VehOdo &lt;= 80407.5\nentropy = 0.659\nsamples = 176\nvalue = [30, 146]\nclass = Yes&#39;),
 Text(0.8696969696969697, 0.5909090909090909, &#39;Color_BROWN &lt;= 0.5\nentropy = 0.625\nsamples = 173\nvalue = [27, 146]\nclass = Yes&#39;),
 Text(0.8656565656565657, 0.5, &#39;Auction_OTHER &lt;= 0.5\nentropy = 0.6\nsamples = 171\nvalue = [25, 146]\nclass = Yes&#39;),
 Text(0.8404040404040404, 0.4090909090909091, &#39;WarrantyCost &lt;= 1029.0\nentropy = 0.397\nsamples = 89\nvalue = [7, 82]\nclass = Yes&#39;),
 Text(0.8363636363636363, 0.3181818181818182, &#39;entropy = 0.0\nsamples = 34\nvalue = [0, 34]\nclass = Yes&#39;),
 Text(0.8444444444444444, 0.3181818181818182, &#39;Color_WHITE &lt;= 0.5\nentropy = 0.55\nsamples = 55\nvalue = [7, 48]\nclass = Yes&#39;),
 Text(0.8363636363636363, 0.22727272727272727, &#39;Size_SMALL SUV &lt;= 0.5\nentropy = 0.348\nsamples = 46\nvalue = [3, 43]\nclass = Yes&#39;),
 Text(0.8323232323232324, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 6189.0\nentropy = 0.262\nsamples = 45\nvalue = [2, 43]\nclass = Yes&#39;),
 Text(0.8282828282828283, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 29\nvalue = [0, 29]\nclass = Yes&#39;),
 Text(0.8363636363636363, 0.045454545454545456, &#39;entropy = 0.544\nsamples = 16\nvalue = [2, 14]\nclass = Yes&#39;),
 Text(0.8404040404040404, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.8525252525252526, 0.22727272727272727, &#39;VehOdo &lt;= 74794.5\nentropy = 0.991\nsamples = 9\nvalue = [4, 5]\nclass = Yes&#39;),
 Text(0.8484848484848485, 0.13636363636363635, &#39;VehBCost &lt;= 5725.0\nentropy = 0.863\nsamples = 7\nvalue = [2, 5]\nclass = Yes&#39;),
 Text(0.8444444444444444, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.8525252525252526, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 5\nvalue = [0, 5]\nclass = Yes&#39;),
 Text(0.8565656565656565, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.8909090909090909, 0.4090909090909091, &#39;VehOdo &lt;= 67001.0\nentropy = 0.759\nsamples = 82\nvalue = [18, 64]\nclass = Yes&#39;),
 Text(0.8767676767676768, 0.3181818181818182, &#39;WarrantyCost &lt;= 1143.5\nentropy = 0.896\nsamples = 48\nvalue = [15, 33]\nclass = Yes&#39;),
 Text(0.8686868686868687, 0.22727272727272727, &#39;VehOdo &lt;= 65565.0\nentropy = 0.759\nsamples = 41\nvalue = [9, 32]\nclass = Yes&#39;),
 Text(0.8646464646464647, 0.13636363636363635, &#39;VehBCost &lt;= 10947.5\nentropy = 0.629\nsamples = 38\nvalue = [6, 32]\nclass = Yes&#39;),
 Text(0.8606060606060606, 0.045454545454545456, &#39;entropy = 0.571\nsamples = 37\nvalue = [5, 32]\nclass = Yes&#39;),
 Text(0.8686868686868687, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.8727272727272727, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.8848484848484849, 0.22727272727272727, &#39;VehicleAge &lt;= 7.5\nentropy = 0.592\nsamples = 7\nvalue = [6, 1]\nclass = No&#39;),
 Text(0.8808080808080808, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 6\nvalue = [6, 0]\nclass = No&#39;),
 Text(0.8888888888888888, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.9050505050505051, 0.3181818181818182, &#39;MMRCurrentAuctionAveragePrice &lt;= 2879.5\nentropy = 0.431\nsamples = 34\nvalue = [3, 31]\nclass = Yes&#39;),
 Text(0.901010101010101, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 2634.5\nentropy = 0.918\nsamples = 9\nvalue = [3, 6]\nclass = Yes&#39;),
 Text(0.896969696969697, 0.13636363636363635, &#39;Color_OTHER &lt;= 0.5\nentropy = 0.592\nsamples = 7\nvalue = [1, 6]\nclass = Yes&#39;),
 Text(0.8929292929292929, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 6\nvalue = [0, 6]\nclass = Yes&#39;),
 Text(0.901010101010101, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.9050505050505051, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.9090909090909091, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 25\nvalue = [0, 25]\nclass = Yes&#39;),
 Text(0.8737373737373737, 0.5, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.8777777777777778, 0.5909090909090909, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.9131313131313131, 0.6818181818181818, &#39;Auction_OTHER &lt;= 0.5\nentropy = 0.253\nsamples = 71\nvalue = [3, 68]\nclass = Yes&#39;),
 Text(0.9090909090909091, 0.5909090909090909, &#39;entropy = 0.0\nsamples = 34\nvalue = [0, 34]\nclass = Yes&#39;),
 Text(0.9171717171717172, 0.5909090909090909, &#39;VehOdo &lt;= 86279.0\nentropy = 0.406\nsamples = 37\nvalue = [3, 34]\nclass = Yes&#39;),
 Text(0.9131313131313131, 0.5, &#39;entropy = 0.0\nsamples = 17\nvalue = [0, 17]\nclass = Yes&#39;),
 Text(0.9212121212121213, 0.5, &#39;VehOdo &lt;= 86404.5\nentropy = 0.61\nsamples = 20\nvalue = [3, 17]\nclass = Yes&#39;),
 Text(0.9171717171717172, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.9252525252525252, 0.4090909090909091, &#39;Color_GREY &lt;= 0.5\nentropy = 0.485\nsamples = 19\nvalue = [2, 17]\nclass = Yes&#39;),
 Text(0.9212121212121213, 0.3181818181818182, &#39;Color_GREEN &lt;= 0.5\nentropy = 0.31\nsamples = 18\nvalue = [1, 17]\nclass = Yes&#39;),
 Text(0.9171717171717172, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 15\nvalue = [0, 15]\nclass = Yes&#39;),
 Text(0.9252525252525252, 0.22727272727272727, &#39;VehOdo &lt;= 88036.0\nentropy = 0.918\nsamples = 3\nvalue = [1, 2]\nclass = Yes&#39;),
 Text(0.9212121212121213, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.9292929292929293, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.9292929292929293, 0.3181818181818182, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.9797979797979798, 0.7727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 7060.0\nentropy = 0.941\nsamples = 67\nvalue = [43, 24]\nclass = No&#39;),
 Text(0.9717171717171718, 0.6818181818181818, &#39;Color_BLACK &lt;= 0.5\nentropy = 0.995\nsamples = 50\nvalue = [27, 23]\nclass = No&#39;),
 Text(0.9676767676767677, 0.5909090909090909, &#39;WarrantyCost &lt;= 1737.0\nentropy = 0.984\nsamples = 47\nvalue = [27, 20]\nclass = No&#39;),
 Text(0.9575757575757575, 0.5, &#39;Color_GREY &lt;= 0.5\nentropy = 0.942\nsamples = 39\nvalue = [25, 14]\nclass = No&#39;),
 Text(0.9535353535353536, 0.4090909090909091, &#39;WarrantyCost &lt;= 1001.5\nentropy = 0.977\nsamples = 34\nvalue = [20, 14]\nclass = No&#39;),
 Text(0.9454545454545454, 0.3181818181818182, &#39;VehOdo &lt;= 79923.0\nentropy = 0.971\nsamples = 15\nvalue = [6, 9]\nclass = Yes&#39;),
 Text(0.9414141414141414, 0.22727272727272727, &#39;MMRCurrentAuctionAveragePrice &lt;= 4856.5\nentropy = 0.994\nsamples = 11\nvalue = [6, 5]\nclass = No&#39;),
 Text(0.9373737373737374, 0.13636363636363635, &#39;Color_WHITE &lt;= 0.5\nentropy = 0.954\nsamples = 8\nvalue = [3, 5]\nclass = Yes&#39;),
 Text(0.9333333333333333, 0.045454545454545456, &#39;entropy = 1.0\nsamples = 6\nvalue = [3, 3]\nclass = No&#39;),
 Text(0.9414141414141414, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.9454545454545454, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 3\nvalue = [3, 0]\nclass = No&#39;),
 Text(0.9494949494949495, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 4\nvalue = [0, 4]\nclass = Yes&#39;),
 Text(0.9616161616161616, 0.3181818181818182, &#39;VehBCost &lt;= 5717.5\nentropy = 0.831\nsamples = 19\nvalue = [14, 5]\nclass = No&#39;),
 Text(0.9575757575757575, 0.22727272727272727, &#39;entropy = 0.0\nsamples = 5\nvalue = [5, 0]\nclass = No&#39;),
 Text(0.9656565656565657, 0.22727272727272727, &#39;TopThreeAmericanName_FORD &lt;= 0.5\nentropy = 0.94\nsamples = 14\nvalue = [9, 5]\nclass = No&#39;),
 Text(0.9616161616161616, 0.13636363636363635, &#39;MMRCurrentAuctionAveragePrice &lt;= 6960.5\nentropy = 0.811\nsamples = 12\nvalue = [9, 3]\nclass = No&#39;),
 Text(0.9575757575757575, 0.045454545454545456, &#39;entropy = 0.684\nsamples = 11\nvalue = [9, 2]\nclass = No&#39;),
 Text(0.9656565656565657, 0.045454545454545456, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.9696969696969697, 0.13636363636363635, &#39;entropy = 0.0\nsamples = 2\nvalue = [0, 2]\nclass = Yes&#39;),
 Text(0.9616161616161616, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 5\nvalue = [5, 0]\nclass = No&#39;),
 Text(0.9777777777777777, 0.5, &#39;VehBCost &lt;= 4780.0\nentropy = 0.811\nsamples = 8\nvalue = [2, 6]\nclass = Yes&#39;),
 Text(0.9737373737373738, 0.4090909090909091, &#39;MMRCurrentAuctionAveragePrice &lt;= 3564.5\nentropy = 0.918\nsamples = 3\nvalue = [2, 1]\nclass = No&#39;),
 Text(0.9696969696969697, 0.3181818181818182, &#39;entropy = 0.0\nsamples = 2\nvalue = [2, 0]\nclass = No&#39;),
 Text(0.9777777777777777, 0.3181818181818182, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;),
 Text(0.9818181818181818, 0.4090909090909091, &#39;entropy = 0.0\nsamples = 5\nvalue = [0, 5]\nclass = Yes&#39;),
 Text(0.9757575757575757, 0.5909090909090909, &#39;entropy = 0.0\nsamples = 3\nvalue = [0, 3]\nclass = Yes&#39;),
 Text(0.9878787878787879, 0.6818181818181818, &#39;Size_LARGE &lt;= 0.5\nentropy = 0.323\nsamples = 17\nvalue = [16, 1]\nclass = No&#39;),
 Text(0.9838383838383838, 0.5909090909090909, &#39;entropy = 0.0\nsamples = 15\nvalue = [15, 0]\nclass = No&#39;),
 Text(0.9919191919191919, 0.5909090909090909, &#39;Color_GREY &lt;= 0.5\nentropy = 1.0\nsamples = 2\nvalue = [1, 1]\nclass = No&#39;),
 Text(0.9878787878787879, 0.5, &#39;entropy = 0.0\nsamples = 1\nvalue = [1, 0]\nclass = No&#39;),
 Text(0.9959595959595959, 0.5, &#39;entropy = 0.0\nsamples = 1\nvalue = [0, 1]\nclass = Yes&#39;)]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Make predictions on training and testing data</span>
<span class="n">prediction_on_train</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
<span class="n">prediction_on_test</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on training data: confusion_matrix</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="n">predictors_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">values_format</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x7f5d5ea75110&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on testing data: confusion_matrix</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">target_test</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">values_format</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/sklearn/utils/deprecation.py:87: FutureWarning: Function plot_confusion_matrix is deprecated; Function `plot_confusion_matrix` is deprecated in 1.0 and will be removed in 1.2. Use one of the class methods: ConfusionMatrixDisplay.from_predictions or ConfusionMatrixDisplay.from_estimator.
  warnings.warn(msg, category=FutureWarning)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x7f5d5e9dcc50&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on training data: accuracy, precision, recall, and f1-score</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">target_train</span><span class="p">,</span> <span class="n">prediction_on_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.92      1.00      0.96      6087
         Yes       0.94      0.41      0.57       913

    accuracy                           0.92      7000
   macro avg       0.93      0.70      0.76      7000
weighted avg       0.92      0.92      0.90      7000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on testing data: accuracy, precision, recall, and f1-score</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">target_test</span><span class="p">,</span> <span class="n">prediction_on_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.90      0.97      0.93      2618
         Yes       0.56      0.25      0.35       382

    accuracy                           0.88      3000
   macro avg       0.73      0.61      0.64      3000
weighted avg       0.86      0.88      0.86      3000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Part 2: Numeric Prediction<a rel="noopener" class="anchor-link" href="#Part-2:-Numeric-Prediction">&#182;</a></h2><hr/>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order for a health insurance company to make money, it needs to collect more
in yearly premiums than it spends on medical care to its beneficiaries. As a result, insurers invest a great deal of time and money in developing models that accurately forecast medical expenses for the insured population.<br/>
<br/>
Medical expenses are difficult to estimate because the most costly conditions are rare and seemingly random. Still, some conditions are more prevalent for certain segments of the population. For instance, lung cancer is more likely among smokers than non-smokers, and heart disease may be more likely among the obese.<br/>
<br/>
The goal of this analysis is to use patient data to estimate the average medical
care expenses for such population segments. These estimates can be used to create actuarial tables that set the price of yearly premiums higher or lower, 
depending on the expected treatment costs.<br/>
<br/>
The insurance data set has 1338 observations of 7 variables.
<br/>
We will use this file to predict the medical expenses.
<br/>
<br/>
VARIABLE DESCRIPTIONS:<br/>
age:          age in years<br/>
sex:          gender<br/>
bmi:          body mass index<br/>
children:   how many children do they have?<br/>
smoker:   do they smoke?<br/>
region:   geographic region<br/>
expenses:   yearly medical expenses<br/>
<br/>
Target variable: <strong>expenses</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Upload and clean data<a rel="noopener" class="anchor-link" href="#Upload-and-clean-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Mounting Google Drive</span>
<span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Import libraries</span>
<span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">regressors</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">regressors</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: regressors in /usr/local/lib/python3.7/dist-packages (0.0.3)
Requirement already satisfied: statsmodels&gt;=0.6.1 in /usr/local/lib/python3.7/dist-packages (from regressors) (0.12.2)
Requirement already satisfied: scikit-learn&gt;=0.17 in /usr/local/lib/python3.7/dist-packages (from regressors) (1.0.2)
Requirement already satisfied: seaborn in /usr/local/lib/python3.7/dist-packages (from regressors) (0.11.2)
Requirement already satisfied: scipy&gt;=0.9 in /usr/local/lib/python3.7/dist-packages (from regressors) (1.7.3)
Requirement already satisfied: numpy&gt;=1.6.1 in /usr/local/lib/python3.7/dist-packages (from regressors) (1.21.6)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from regressors) (1.3.5)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from regressors) (3.2.2)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.17-&gt;regressors) (1.1.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&gt;=0.17-&gt;regressors) (3.1.0)
Requirement already satisfied: patsy&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from statsmodels&gt;=0.6.1-&gt;regressors) (0.5.2)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;regressors) (2.8.2)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;regressors) (2022.2.1)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from patsy&gt;=0.5-&gt;statsmodels&gt;=0.6.1-&gt;regressors) (1.15.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;regressors) (1.4.4)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;regressors) (3.0.9)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;regressors) (0.11.0)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib-&gt;regressors) (4.1.1)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Read data</span>
<span class="n">insurance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/DL_data/insurance.csv&quot;</span><span class="p">)</span>
<span class="n">insurance</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>bmi</th>
      <th>children</th>
      <th>smoker</th>
      <th>region</th>
      <th>expenses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
      <td>female</td>
      <td>27.9</td>
      <td>0</td>
      <td>yes</td>
      <td>southwest</td>
      <td>16884.92</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>male</td>
      <td>33.8</td>
      <td>1</td>
      <td>no</td>
      <td>southeast</td>
      <td>1725.55</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28</td>
      <td>male</td>
      <td>33.0</td>
      <td>3</td>
      <td>no</td>
      <td>southeast</td>
      <td>4449.46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33</td>
      <td>male</td>
      <td>22.7</td>
      <td>0</td>
      <td>no</td>
      <td>northwest</td>
      <td>21984.47</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32</td>
      <td>male</td>
      <td>28.9</td>
      <td>0</td>
      <td>no</td>
      <td>northwest</td>
      <td>3866.86</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1333</th>
      <td>50</td>
      <td>male</td>
      <td>31.0</td>
      <td>3</td>
      <td>no</td>
      <td>northwest</td>
      <td>10600.55</td>
    </tr>
    <tr>
      <th>1334</th>
      <td>18</td>
      <td>female</td>
      <td>31.9</td>
      <td>0</td>
      <td>no</td>
      <td>northeast</td>
      <td>2205.98</td>
    </tr>
    <tr>
      <th>1335</th>
      <td>18</td>
      <td>female</td>
      <td>36.9</td>
      <td>0</td>
      <td>no</td>
      <td>southeast</td>
      <td>1629.83</td>
    </tr>
    <tr>
      <th>1336</th>
      <td>21</td>
      <td>female</td>
      <td>25.8</td>
      <td>0</td>
      <td>no</td>
      <td>southwest</td>
      <td>2007.95</td>
    </tr>
    <tr>
      <th>1337</th>
      <td>61</td>
      <td>female</td>
      <td>29.1</td>
      <td>0</td>
      <td>yes</td>
      <td>northwest</td>
      <td>29141.36</td>
    </tr>
  </tbody>
</table>
<p>1338 rows &#215; 7 columns</p>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Show the head rows of a data frame</span>
<span class="n">insurance</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>bmi</th>
      <th>children</th>
      <th>smoker</th>
      <th>region</th>
      <th>expenses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
      <td>female</td>
      <td>27.9</td>
      <td>0</td>
      <td>yes</td>
      <td>southwest</td>
      <td>16884.92</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>male</td>
      <td>33.8</td>
      <td>1</td>
      <td>no</td>
      <td>southeast</td>
      <td>1725.55</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28</td>
      <td>male</td>
      <td>33.0</td>
      <td>3</td>
      <td>no</td>
      <td>southeast</td>
      <td>4449.46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33</td>
      <td>male</td>
      <td>22.7</td>
      <td>0</td>
      <td>no</td>
      <td>northwest</td>
      <td>21984.47</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32</td>
      <td>male</td>
      <td>28.9</td>
      <td>0</td>
      <td>no</td>
      <td>northwest</td>
      <td>3866.86</td>
    </tr>
  </tbody>
</table>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine variable type</span>
<span class="n">insurance</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>age           int64
sex          object
bmi         float64
children      int64
smoker       object
region       object
expenses    float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Change categorical variables to &quot;category&quot;</span>
<span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;smoker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;smoker&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine variable type</span>
<span class="n">insurance</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>age            int64
sex         category
bmi          float64
children       int64
smoker      category
region      category
expenses     float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Data exploration: some examples</span>
<span class="c1"># Histogram of insurance expenses</span>
<span class="n">snsplot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;expenses&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">insurance</span><span class="p">)</span>
<span class="n">snsplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogram of expenses in the insurance data set&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Histogram of expenses in the insurance data set&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># exploring relationships among all numeric variables: correlation matrix</span>
<span class="n">insurance</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>bmi</th>
      <th>children</th>
      <th>expenses</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>age</th>
      <td>1.000000</td>
      <td>0.109341</td>
      <td>0.042469</td>
      <td>0.299008</td>
    </tr>
    <tr>
      <th>bmi</th>
      <td>0.109341</td>
      <td>1.000000</td>
      <td>0.012645</td>
      <td>0.198576</td>
    </tr>
    <tr>
      <th>children</th>
      <td>0.042469</td>
      <td>0.012645</td>
      <td>1.000000</td>
      <td>0.067998</td>
    </tr>
    <tr>
      <th>expenses</th>
      <td>0.299008</td>
      <td>0.198576</td>
      <td>0.067998</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Partition the data set for regression model<a rel="noopener" class="anchor-link" href="#Partition-the-data-set-for-regression-model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Create dummy variables</span>
<span class="n">insurance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">insurance</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span><span class="s1">&#39;smoker&#39;</span><span class="p">,</span><span class="s1">&#39;region&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">insurance</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">

  <div>
    <div class="colab-df-container">
      <div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>bmi</th>
      <th>children</th>
      <th>expenses</th>
      <th>sex_male</th>
      <th>smoker_yes</th>
      <th>region_northwest</th>
      <th>region_southeast</th>
      <th>region_southwest</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
      <td>27.9</td>
      <td>0</td>
      <td>16884.92</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>33.8</td>
      <td>1</td>
      <td>1725.55</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28</td>
      <td>33.0</td>
      <td>3</td>
      <td>4449.46</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33</td>
      <td>22.7</td>
      <td>0</td>
      <td>21984.47</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32</td>
      <td>28.9</td>
      <td>0</td>
      <td>3866.86</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1333</th>
      <td>50</td>
      <td>31.0</td>
      <td>3</td>
      <td>10600.55</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1334</th>
      <td>18</td>
      <td>31.9</td>
      <td>0</td>
      <td>2205.98</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1335</th>
      <td>18</td>
      <td>36.9</td>
      <td>0</td>
      <td>1629.83</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1336</th>
      <td>21</td>
      <td>25.8</td>
      <td>0</td>
      <td>2007.95</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1337</th>
      <td>61</td>
      <td>29.1</td>
      <td>0</td>
      <td>29141.36</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1338 rows &#215; 9 columns</p>
</div>
      
        
  
    
    
  
      
      
  

      
    </div>
  </div>
  
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Partition the data</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">insurance</span><span class="p">[</span><span class="s1">&#39;expenses&#39;</span><span class="p">]</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">insurance</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;expenses&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predictors_train</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">predictors_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">predictors_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">target_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">target_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(936, 8) (402, 8) (936,) (402,)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the distribution of target variable for training data set</span>
<span class="n">snsplot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">target_train</span><span class="p">)</span>
<span class="n">snsplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogram of expenses in the training data set&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Histogram of expenses in the training data set&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the distribution of target variable for testing data set</span>
<span class="n">snsplot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">target_test</span><span class="p">)</span>
<span class="n">snsplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Histogram of expenses in the testing data set&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Histogram of expenses in the testing data set&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Multiple linear regression<a rel="noopener" class="anchor-link" href="#Multiple-linear-regression">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Build a multiple linear regression model with all predictors</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&#160;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression()</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Show model summary</span>
<span class="n">predictor_names</span> <span class="o">=</span> <span class="n">predictors_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="n">stats</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">predictors_train</span><span class="p">,</span> <span class="n">target_train</span><span class="p">,</span> <span class="n">predictor_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Residuals:
        Min         1Q   Median       3Q        Max
-30302.4407 -1343.2315 985.6509 2988.446 11148.5211


Coefficients:
                      Estimate   Std. Error  t value   p value
_intercept       -11836.117831  1191.289921  -9.9355  0.000000
age                 256.402924    10.186903  25.1699  0.000000
bmi                 335.414456    16.372545  20.4864  0.000000
children            472.939931   166.843442   2.8346  0.004687
sex_male            -47.692891   400.980436  -0.1189  0.905348
smoker_yes        23435.046128   501.984750  46.6848  0.000000
region_northwest   -561.353117   545.419326  -1.0292  0.303645
region_southeast   -995.537125   551.901974  -1.8038  0.071580
region_southwest   -798.824371   541.710520  -1.4746  0.140648
---
R-squared:  0.73096,    Adjusted R-squared:  0.72864
F-statistic: 314.82 on 8 features
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q4. How the expenses change when we increase the bmi by 1? <br/>
The new bmi estimate would increase by $335.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Make predictions on training and testing data</span>
<span class="n">prediction_on_train</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
<span class="n">prediction_on_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on training data: MAE and RMSE</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">target_train</span><span class="p">,</span> <span class="n">prediction_on_train</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">target_train</span><span class="p">,</span> <span class="n">prediction_on_train</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAE: &quot;</span><span class="p">,</span> <span class="n">MAE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE: &quot;</span><span class="p">,</span> <span class="n">RMSE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>MAE:  4246.304346615992
RMSE:  6158.809677366775
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="c1"># Examine the evaluation results on testing data: MAE and RMSE</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">target_test</span><span class="p">,</span> <span class="n">prediction_on_test</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">target_test</span><span class="p">,</span> <span class="n">prediction_on_test</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAE: &quot;</span><span class="p">,</span> <span class="n">MAE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE: &quot;</span><span class="p">,</span> <span class="n">RMSE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>MAE:  4011.3808850910846
RMSE:  5773.711137570041
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">jupyter</span> <span class="n">nbconvert</span> <span class="o">--</span><span class="n">to</span> <span class="n">html</span> <span class="s2">&quot;/content/drive/MyDrive/DL_lab/Lab2: Classification and Numeric Prediction.ipynb&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[NbConvertApp] WARNING | pattern &#39;/content/drive/MyDrive/DL_lab/Lab2: Classification and Numeric Prediction.ipynb&#39; matched no files
This application is used to convert notebook files (*.ipynb)
        to various other formats.

        WARNING: THE COMMANDLINE INTERFACE MAY CHANGE IN FUTURE RELEASES.

Options
=======
The options below are convenience aliases to configurable class-options,
as listed in the &quot;Equivalent to&quot; description-line of the aliases.
To see all configurable class-options for some &lt;cmd&gt;, use:
    &lt;cmd&gt; --help-all

--debug
    set log level to logging.DEBUG (maximize logging output)
    Equivalent to: [--Application.log_level=10]
--show-config
    Show the application&#39;s configuration (human-readable format)
    Equivalent to: [--Application.show_config=True]
--show-config-json
    Show the application&#39;s configuration (json format)
    Equivalent to: [--Application.show_config_json=True]
--generate-config
    generate default config file
    Equivalent to: [--JupyterApp.generate_config=True]
-y
    Answer yes to any questions instead of prompting.
    Equivalent to: [--JupyterApp.answer_yes=True]
--execute
    Execute the notebook prior to export.
    Equivalent to: [--ExecutePreprocessor.enabled=True]
--allow-errors
    Continue notebook execution even if one of the cells throws an error and include the error message in the cell output (the default behaviour is to abort conversion). This flag is only relevant if &#39;--execute&#39; was specified, too.
    Equivalent to: [--ExecutePreprocessor.allow_errors=True]
--stdin
    read a single notebook file from stdin. Write the resulting notebook with default basename &#39;notebook.*&#39;
    Equivalent to: [--NbConvertApp.from_stdin=True]
--stdout
    Write notebook output to stdout instead of files.
    Equivalent to: [--NbConvertApp.writer_class=StdoutWriter]
--inplace
    Run nbconvert in place, overwriting the existing notebook (only 
            relevant when converting to notebook format)
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory=]
--clear-output
    Clear output of current file and save in place, 
            overwriting the existing notebook.
    Equivalent to: [--NbConvertApp.use_output_suffix=False --NbConvertApp.export_format=notebook --FilesWriter.build_directory= --ClearOutputPreprocessor.enabled=True]
--no-prompt
    Exclude input and output prompts from converted document.
    Equivalent to: [--TemplateExporter.exclude_input_prompt=True --TemplateExporter.exclude_output_prompt=True]
--no-input
    Exclude input cells and output prompts from converted document. 
            This mode is ideal for generating code-free reports.
    Equivalent to: [--TemplateExporter.exclude_output_prompt=True --TemplateExporter.exclude_input=True]
--log-level=&lt;Enum&gt;
    Set the log level by value or name.
    Choices: any of [0, 10, 20, 30, 40, 50, &#39;DEBUG&#39;, &#39;INFO&#39;, &#39;WARN&#39;, &#39;ERROR&#39;, &#39;CRITICAL&#39;]
    Default: 30
    Equivalent to: [--Application.log_level]
--config=&lt;Unicode&gt;
    Full path of a config file.
    Default: &#39;&#39;
    Equivalent to: [--JupyterApp.config_file]
--to=&lt;Unicode&gt;
    The export format to be used, either one of the built-in formats
            [&#39;asciidoc&#39;, &#39;custom&#39;, &#39;html&#39;, &#39;latex&#39;, &#39;markdown&#39;, &#39;notebook&#39;, &#39;pdf&#39;, &#39;python&#39;, &#39;rst&#39;, &#39;script&#39;, &#39;slides&#39;]
            or a dotted object name that represents the import path for an
            `Exporter` class
    Default: &#39;html&#39;
    Equivalent to: [--NbConvertApp.export_format]
--template=&lt;Unicode&gt;
    Name of the template file to use
    Default: &#39;&#39;
    Equivalent to: [--TemplateExporter.template_file]
--writer=&lt;DottedObjectName&gt;
    Writer class used to write the 
                                        results of the conversion
    Default: &#39;FilesWriter&#39;
    Equivalent to: [--NbConvertApp.writer_class]
--post=&lt;DottedOrNone&gt;
    PostProcessor class used to write the
                                        results of the conversion
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.postprocessor_class]
--output=&lt;Unicode&gt;
    overwrite base name use for output files.
                can only be used when converting one notebook at a time.
    Default: &#39;&#39;
    Equivalent to: [--NbConvertApp.output_base]
--output-dir=&lt;Unicode&gt;
    Directory to write output(s) to. Defaults
                                  to output to the directory of each notebook. To recover
                                  previous default behaviour (outputting to the current 
                                  working directory) use . as the flag value.
    Default: &#39;&#39;
    Equivalent to: [--FilesWriter.build_directory]
--reveal-prefix=&lt;Unicode&gt;
    The URL prefix for reveal.js (version 3.x).
            This defaults to the reveal CDN, but can be any url pointing to a copy 
            of reveal.js. 
            For speaker notes to work, this must be a relative path to a local 
            copy of reveal.js: e.g., &quot;reveal.js&quot;.
            If a relative path is given, it must be a subdirectory of the
            current directory (from which the server is run).
            See the usage documentation
            (https://nbconvert.readthedocs.io/en/latest/usage.html#reveal-js-html-slideshow)
            for more details.
    Default: &#39;&#39;
    Equivalent to: [--SlidesExporter.reveal_url_prefix]
--nbformat=&lt;Enum&gt;
    The nbformat version to write.
            Use this to downgrade notebooks.
    Choices: any of [1, 2, 3, 4]
    Default: 4
    Equivalent to: [--NotebookExporter.nbformat_version]

Examples
--------

    The simplest way to use nbconvert is

            &gt; jupyter nbconvert mynotebook.ipynb

            which will convert mynotebook.ipynb to the default format (probably HTML).

            You can specify the export format with `--to`.
            Options include [&#39;asciidoc&#39;, &#39;custom&#39;, &#39;html&#39;, &#39;latex&#39;, &#39;markdown&#39;, &#39;notebook&#39;, &#39;pdf&#39;, &#39;python&#39;, &#39;rst&#39;, &#39;script&#39;, &#39;slides&#39;].

            &gt; jupyter nbconvert --to latex mynotebook.ipynb

            Both HTML and LaTeX support multiple output templates. LaTeX includes
            &#39;base&#39;, &#39;article&#39; and &#39;report&#39;.  HTML includes &#39;basic&#39; and &#39;full&#39;. You
            can specify the flavor of the format used.

            &gt; jupyter nbconvert --to html --template basic mynotebook.ipynb

            You can also pipe the output to stdout, rather than a file

            &gt; jupyter nbconvert mynotebook.ipynb --stdout

            PDF is generated via latex

            &gt; jupyter nbconvert mynotebook.ipynb --to pdf

            You can get (and serve) a Reveal.js-powered slideshow

            &gt; jupyter nbconvert myslides.ipynb --to slides --post serve

            Multiple notebooks can be given at the command line in a couple of 
            different ways:

            &gt; jupyter nbconvert notebook*.ipynb
            &gt; jupyter nbconvert notebook1.ipynb notebook2.ipynb

            or you can specify the notebooks list in a config file, containing::

                c.NbConvertApp.notebooks = [&quot;my_notebook.ipynb&quot;]

            &gt; jupyter nbconvert --config mycfg.py

To see all available configurables, use `--help-all`.

</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>


 



<script type="module" src="https://s.brightspace.com/lib/bsi/20.22.9-241/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.3,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.22.9-241/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>